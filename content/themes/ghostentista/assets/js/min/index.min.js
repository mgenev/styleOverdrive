jQuery(function(e){function t(t){t.preventDefault();var a=e("#more-posts"),o=a.attr("href");a.parent().remove(),e.ajax({url:o+" #main-content",cache:!0,contentType:"html",dataFilter:s,success:function(e,t){switch(t){case"error":alert("Something terrible has happened. Sky is falling on your head.");break;case"success":h.append(e),h.find("#more-posts")}}})}function a(){var t=JSON.parse(localStorage.getItem("relatedPosts")),a=e("nav.related-posts ul");t.length>0&&a.length>0?a.html(t):e("nav.related-posts").remove()}function o(){var t=e("span[name='post-content']");t.length>0?e("html,body").animate({scrollTop:t.offset().top-30},"slow"):e("html,body").animate({scrollTop:0},"slow")}function s(t,a){return a=a||"text","html"==a||"text"==a?(t=t.replace(/<link.*?\/>/gi,""),t=t.replace(/<script.*?>([\w\W]*?)<\/script>/gi,""),t=e(t).filter("#main-content").children().parent(),t.html()):t}function n(t){t.preventDefault();var a=e(this).attr("href"),o=e(this).attr("title")||null;r.pushState({},o,a)}var r=window.History,i=location.host,l="a[href^='"+i+"'], a[href^='/'], a[href^='./'], a[href^='../'], a[href^='#']",c=e(window),h=e("#main-content"),p=e(l),d=e("#related-posts-container"),g=e("#site-head-content"),f=e("#site-head");o(),c.scroll(function(){var t=g.height()+40,a=f.height()-c.scrollTop();if(a>t){var o=a/2-t/2+"px";console.log(o,f.height(),c.scrollTop()),g.parent().css({paddingTop:o})}var s=e("#secondaryTitle");0>=a?s.hasClass("displayed")||(s.addClass("displayed"),s.animate({top:"0px"},500)):s.hasClass("displayed")&&(s.removeClass("displayed"),s.animate({top:"-200px"},500))});var m=e("#site-head h1").text().replace(/\s+/g," "),u=e("#site-head h2").text().replace(/\s+/g," "),v=e('<nav id="secondaryTitle"><div class="siteInfo"><h1>'+m+"</h1><h2>"+u+'</h2></div><a href="#top" id="scroll-to-top"></a></nav>');if(e("body").prepend(v),e("#scroll-to-top").click(function(t){t.preventDefault(),e("html, body").animate({scrollTop:0},200)}),c.resize(function(){for(var t=e(".post"),a=0;a<t.length;a+=2){console.log(a);var o=e(t[a]).find(".post-title"),s=e(t[a+1]).find(".post-title");o.css({height:"auto",paddingTop:0}),s.css({height:"auto",paddingTop:0});var n=o.innerHeight(),r=s.innerHeight(),i=Math.max(n,r)+"px",l=Math.abs(n-r)/2+"px";o.css({height:i,paddingTop:r>n?l:0}),s.css({height:i,paddingTop:n>r?l:0})}c.trigger("scroll")}),d.length>0){var y=d.clone();d.remove(),localStorage.setItem("relatedPosts",JSON.stringify(y.html()))}else a();r.enabled&&(r.Adapter.bind(window,"statechange",function(){var i=r.getState();e.ajax({url:i.url+" #main-content",cache:!0,contentType:"html",dataFilter:s,success:function(e,s){switch(s){case"error":alert("Something terrible has happened. Sky is falling on your head.");break;case"success":h.html(e).find(l).not("#more-posts").click(n),h.find("#more-posts").click(t),Prism.highlightElement(),o(),a()}}})}),console.log(p.not("#more-posts")),p.not("#more-posts").click(n)),e("#more-posts").click(t),setTimeout(function(){c.trigger("scroll"),c.trigger("resize")},200)});